<!doctype html>
<html lang="pt-BR">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BARCODER'S - Sistema de Gestão de Estoque</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="admin-login.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .loading {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="bg-gray-100 min-h-full"><!-- Tela de Login -->
  <div id="loginScreen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-500 to-purple-600">
   <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md">
    <div class="text-center mb-8">
     <div class="w-16 h-16 bg-indigo-600 rounded-lg flex items-center justify-center mx-auto mb-4">
      <svg class="w-8 h-8 text-white" fill="currentColor" viewbox="0 0 24 24"><path d="M3 4h18v2H3V4zm0 4h18v2H3V8zm0 4h18v2H3v-2zm0 4h18v2H3v-2z" />
      </svg>
     </div>
     <h1 class="text-2xl font-bold text-gray-800">BARCODER'S</h1>
     <p class="text-gray-600">Sistema de Gestão de Estoque</p>
    </div>
    <form id="loginForm" class="space-y-6">
     <div><label for="cpf" class="block text-sm font-medium text-gray-700 mb-2">CPF</label> <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
     </div>
     <div><label for="password" class="block text-sm font-medium text-gray-700 mb-2">Senha</label> <input type="password" id="password" name="password" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
     </div><button type="submit" id="loginBtn" class="w-full bg-indigo-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-indigo-700 transition-colors"> <span id="loginBtnText">Entrar</span>
      <div id="loginSpinner" class="hidden inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin ml-2"></div></button>
     <div id="loginError" class="hidden text-red-600 text-sm text-center bg-red-50 p-3 rounded-lg">
      CPF ou senha incorretos
     </div>
     <div class="text-center text-sm text-gray-500 bg-blue-50 p-3 rounded-lg">
      <p class="font-medium text-blue-700 mb-1">Acesso com dados do banco:</p>
      <p>Use seu CPF cadastrado na tabela Funcionarios</p>
     </div>
    </form>
   </div>
  </div><!-- Dashboard -->
  <div id="dashboard" class="hidden min-h-screen bg-gray-50"><!-- Header -->
   <header class="bg-white shadow-sm border-b">
    <div class="px-6 py-4">
     <div class="flex items-center justify-between">
      <div class="flex items-center space-x-4">
       <div class="w-10 h-10 bg-indigo-600 rounded-lg flex items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="currentColor" viewbox="0 0 24 24"><path d="M3 4h18v2H3V4zm0 4h18v2H3V8zm0 4h18v2H3v-2zm0 4h18v2H3v-2z" />
        </svg>
       </div>
       <div>
        <h1 class="text-xl font-bold text-gray-800">BARCODER'S</h1>
        <p class="text-gray-500 text-sm">Painel Administrativo</p>
       </div>
      </div>
      <div class="flex items-center space-x-4"><span class="text-gray-600">Bem-vindo, <span id="currentUser">Admin</span></span> <button onclick="logout()" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors"> Sair </button>
      </div>
     </div>
    </div>
   </header><!-- Navigation -->
   <nav class="bg-white border-b">
    <div class="px-6">
     <div class="flex space-x-8"><button onclick="showSection('dashboard')" class="nav-btn py-4 px-2 border-b-2 border-indigo-600 text-indigo-600 font-medium"> Dashboard </button> <button onclick="showSection('estoque')" class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700"> Estoque </button> <button onclick="showSection('movimentacao')" class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700"> Movimentação </button> <button onclick="showSection('contacts')" class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700"> Contatos </button>
     </div>
    </div>
   </nav><!-- Content -->
   <main class="p-6"><!-- Dashboard Principal -->
    <div id="dashboardSection" class="fade-in">
     <div class="mb-6">
      <h2 class="text-2xl font-bold text-gray-800 mb-2">Dashboard do Sistema</h2>
      <p class="text-gray-600">Visão geral do estoque e movimentações</p>
     </div><!-- Estatísticas em Tempo Real -->
     <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg p-8 mb-6">
      <h3 class="text-xl font-bold text-white text-center mb-8">Estatísticas do Sistema</h3>
      <div class="grid md:grid-cols-4 gap-6">
       <div class="stat-card rounded-lg p-6 text-center">
        <div id="totalItens" class="text-3xl font-bold text-white mb-2 loading">
         ---
        </div>
        <div class="text-indigo-200">
         Itens em Estoque
        </div>
       </div>
       <div class="stat-card rounded-lg p-6 text-center">
        <div id="totalFornecedores" class="text-3xl font-bold text-white mb-2 loading">
         ---
        </div>
        <div class="text-indigo-200">
         Fornecedores Ativos
        </div>
       </div>
       <div class="stat-card rounded-lg p-6 text-center">
        <div id="totalMaquinas" class="text-3xl font-bold text-white mb-2 loading">
         ---
        </div>
        <div class="text-indigo-200">
         Máquinas Cadastradas
        </div>
       </div>
       <div class="stat-card rounded-lg p-6 text-center">
        <div id="movimentacoesHoje" class="text-3xl font-bold text-white mb-2 loading">
         ---
        </div>
        <div class="text-indigo-200">
         Movimentações Hoje
        </div>
       </div>
      </div>
     </div><!-- Resumo de Atividades Recentes -->
     <div class="grid md:grid-cols-2 gap-6">
      <div class="bg-white rounded-lg p-6 shadow-sm">
       <h4 class="text-lg font-semibold text-gray-800 mb-4">Últimas Entradas</h4>
       <div id="ultimasEntradas" class="space-y-3">
        <div class="loading text-gray-500">
         Carregando dados...
        </div>
       </div>
      </div>
      <div class="bg-white rounded-lg p-6 shadow-sm">
       <h4 class="text-lg font-semibold text-gray-800 mb-4">Últimas Movimentações</h4>
       <div id="ultimasMovimentacoes" class="space-y-3">
        <div class="loading text-gray-500">
         Carregando dados...
        </div>
       </div>
      </div>
     </div>
    </div><!-- Seção Estoque -->
    <div id="estoqueSection" class="hidden fade-in">
     <div class="mb-6 flex items-center justify-between">
      <div>
       <h2 class="text-2xl font-bold text-gray-800 mb-2">Controle de Estoque</h2>
       <p class="text-gray-600">Gerencie matérias-primas e lotes</p>
      </div><button onclick="showAddItemModal()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"> Adicionar Item </button>
     </div><!-- Filtros -->
     <div class="bg-white rounded-lg p-4 shadow-sm mb-6">
      <div class="grid md:grid-cols-4 gap-4"><select id="filtroTipo" onchange="filtrarEstoque()" class="px-3 py-2 border border-gray-300 rounded-lg"> <option value="">Todos os Tipos</option> </select> <select id="filtroFornecedor" onchange="filtrarEstoque()" class="px-3 py-2 border border-gray-300 rounded-lg"> <option value="">Todos os Fornecedores</option> </select> <input type="text" id="filtroBarcode" placeholder="Buscar por código de barras" onkeyup="filtrarEstoque()" class="px-3 py-2 border border-gray-300 rounded-lg"> <button onclick="carregarEstoque()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200"> Atualizar </button>
      </div>
     </div><!-- Lista de Estoque -->
     <div class="bg-white rounded-lg shadow-sm overflow-hidden">
      <div class="px-6 py-4 bg-gray-50 border-b">
       <h3 class="text-lg font-semibold text-gray-800">Itens em Estoque</h3>
      </div>
      <div id="listaEstoque" class="divide-y divide-gray-200">
       <div class="p-6 text-center text-gray-500 loading">
        Carregando estoque...
       </div>
      </div>
     </div>
    </div><!-- Seção Movimentação -->
    <div id="movimentacaoSection" class="hidden fade-in">
     <div class="mb-6 flex items-center justify-between">
      <div>
       <h2 class="text-2xl font-bold text-gray-800 mb-2">Movimentações</h2>
       <p class="text-gray-600">Registre entradas e saídas de material</p>
      </div>
      <div class="flex space-x-2"><button onclick="showEntradaModal()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700"> Registrar Entrada </button> <button onclick="showMovimentoModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"> Registrar Movimento </button>
      </div>
     </div><!-- Histórico de Movimentações -->
     <div class="bg-white rounded-lg shadow-sm overflow-hidden">
      <div class="px-6 py-4 bg-gray-50 border-b">
       <h3 class="text-lg font-semibold text-gray-800">Histórico de Movimentações</h3>
      </div>
      <div id="listaMovimentacoes" class="divide-y divide-gray-200">
       <div class="p-6 text-center text-gray-500 loading">
        Carregando movimentações...
       </div>
      </div>
     </div>
    </div><!-- Seção Contatos -->
    <div id="contactsSection" class="hidden fade-in">
     <div class="mb-6 flex items-center justify-between">
      <div>
       <h2 class="text-2xl font-bold text-gray-800 mb-2">Gerenciar Contatos</h2>
       <p class="text-gray-600">Mensagens recebidas do formulário público</p>
      </div><button onclick="carregarContatos()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200"> Atualizar </button>
     </div><!-- Lista de Contatos -->
     <div class="bg-white rounded-lg shadow-sm overflow-hidden">
      <div class="px-6 py-4 bg-gray-50 border-b">
       <h3 class="text-lg font-semibold text-gray-800">Mensagens Recebidas</h3>
      </div>
      <div id="contactsList" class="divide-y divide-gray-200">
       <div class="p-6 text-center text-gray-500 loading">
        Carregando contatos...
       </div>
      </div>
     </div>
    </div>
   </main>
  </div>
  <script>
        // Configuração da API
        const API_BASE_URL = '/api'; // Ajuste conforme sua configuração
        let currentUser = null;
        let estoqueData = [];
        let movimentacaoData = [];
        let contatosData = [];

        // Formatação de CPF
        function formatCPF(cpf) {
            return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        }

        function removeCPFMask(cpf) {
            return cpf.replace(/\D/g, '');
        }

        // Máscara de CPF no input
        document.getElementById('cpf').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 11) {
                value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
                e.target.value = value;
            }
        });

        // Login integrado com banco
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const cpf = removeCPFMask(document.getElementById('cpf').value);
            const password = document.getElementById('password').value;
            const loginBtn = document.getElementById('loginBtn');
            const loginBtnText = document.getElementById('loginBtnText');
            const loginSpinner = document.getElementById('loginSpinner');
            const loginError = document.getElementById('loginError');
            
            // Mostrar loading
            loginBtnText.textContent = 'Verificando...';
            loginSpinner.classList.remove('hidden');
            loginBtn.disabled = true;
            loginError.classList.add('hidden');
            
            try {
                // Fazer requisição para API de login
                const response = await fetch(`${API_BASE_URL}/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ cpf, password })
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    // Login bem-sucedido
                    currentUser = result.funcionario;
                    document.getElementById('loginScreen').classList.add('hidden');
                    document.getElementById('dashboard').classList.remove('hidden');
                    document.getElementById('currentUser').textContent = currentUser.nome || formatCPF(cpf);
                    
                    // Carregar dados iniciais
                    await carregarDashboard();
                } else {
                    // Erro de login
                    loginError.textContent = result.message || 'CPF ou senha incorretos';
                    loginError.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Erro no login:', error);
                loginError.textContent = 'Erro de conexão. Tente novamente.';
                loginError.classList.remove('hidden');
            } finally {
                // Restaurar botão
                loginBtnText.textContent = 'Entrar';
                loginSpinner.classList.add('hidden');
                loginBtn.disabled = false;
            }
        });

        // Logout
        function logout() {
            currentUser = null;
            estoqueData = [];
            movimentacaoData = [];
            contatosData = [];
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('loginForm').reset();
        }

        // Navegação
        function showSection(section) {
            // Atualizar botões de navegação
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('border-indigo-600', 'text-indigo-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            event.target.classList.remove('border-transparent', 'text-gray-500');
            event.target.classList.add('border-indigo-600', 'text-indigo-600');
            
            // Esconder todas as seções
            document.getElementById('dashboardSection').classList.add('hidden');
            document.getElementById('estoqueSection').classList.add('hidden');
            document.getElementById('movimentacaoSection').classList.add('hidden');
            document.getElementById('contactsSection').classList.add('hidden');
            
            // Mostrar seção selecionada
            if (section === 'dashboard') {
                document.getElementById('dashboardSection').classList.remove('hidden');
                carregarDashboard();
            } else if (section === 'estoque') {
                document.getElementById('estoqueSection').classList.remove('hidden');
                carregarEstoque();
            } else if (section === 'movimentacao') {
                document.getElementById('movimentacaoSection').classList.remove('hidden');
                carregarMovimentacoes();
            } else if (section === 'contacts') {
                document.getElementById('contactsSection').classList.remove('hidden');
                carregarContatos();
            }
        }

        // Carregar Dashboard
        async function carregarDashboard() {
            try {
                // Carregar estatísticas
                const statsResponse = await fetch(`${API_BASE_URL}/dashboard/stats`);
                if (statsResponse.ok) {
                    const stats = await statsResponse.json();
                    document.getElementById('totalItens').textContent = stats.totalItens || '0';
                    document.getElementById('totalFornecedores').textContent = stats.totalFornecedores || '0';
                    document.getElementById('totalMaquinas').textContent = stats.totalMaquinas || '0';
                    document.getElementById('movimentacoesHoje').textContent = stats.movimentacoesHoje || '0';
                    
                    // Remover classe loading
                    document.querySelectorAll('.loading').forEach(el => el.classList.remove('loading'));
                }

                // Carregar atividades recentes
                const atividadesResponse = await fetch(`${API_BASE_URL}/dashboard/atividades`);
                if (atividadesResponse.ok) {
                    const atividades = await atividadesResponse.json();
                    
                    // Últimas entradas
                    const ultimasEntradas = document.getElementById('ultimasEntradas');
                    if (atividades.entradas && atividades.entradas.length > 0) {
                        ultimasEntradas.innerHTML = atividades.entradas.map(entrada => `
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                <div>
                                    <p class="font-medium">${entrada.tipo_mp}</p>
                                    <p class="text-sm text-gray-500">${entrada.fornecedor}</p>
                                </div>
                                <div class="text-right">
                                    <p class="font-medium">${entrada.quantidade}</p>
                                    <p class="text-sm text-gray-500">${formatDate(entrada.data_registro)}</p>
                                </div>
                            </div>
                        `).join('');
                    } else {
                        ultimasEntradas.innerHTML = '<p class="text-gray-500">Nenhuma entrada recente</p>';
                    }

                    // Últimas movimentações
                    const ultimasMovimentacoes = document.getElementById('ultimasMovimentacoes');
                    if (atividades.movimentacoes && atividades.movimentacoes.length > 0) {
                        ultimasMovimentacoes.innerHTML = atividades.movimentacoes.map(mov => `
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                <div>
                                    <p class="font-medium">${mov.tipo_mp}</p>
                                    <p class="text-sm text-gray-500">Máquina ${mov.maquina_id}</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm text-gray-500">${formatDate(mov.data_movimento)}</p>
                                </div>
                            </div>
                        `).join('');
                    } else {
                        ultimasMovimentacoes.innerHTML = '<p class="text-gray-500">Nenhuma movimentação recente</p>';
                    }
                }
            } catch (error) {
                console.error('Erro ao carregar dashboard:', error);
                showNotification('Erro ao carregar dados do dashboard', 'error');
            }
        }

        // Carregar Estoque
        async function carregarEstoque() {
            try {
                const response = await fetch(`${API_BASE_URL}/estoque`);
                if (response.ok) {
                    estoqueData = await response.json();
                    renderizarEstoque(estoqueData);
                    carregarFiltros();
                } else {
                    throw new Error('Erro ao carregar estoque');
                }
            } catch (error) {
                console.error('Erro ao carregar estoque:', error);
                document.getElementById('listaEstoque').innerHTML = `
                    <div class="p-6 text-center text-red-500">
                        Erro ao carregar dados do estoque
                    </div>
                `;
            }
        }

        // Renderizar lista de estoque
        function renderizarEstoque(dados) {
            const lista = document.getElementById('listaEstoque');
            
            if (dados.length === 0) {
                lista.innerHTML = `
                    <div class="p-6 text-center text-gray-500">
                        Nenhum item encontrado no estoque
                    </div>
                `;
                return;
            }

            lista.innerHTML = dados.map(item => `
                <div class="p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-4 mb-2">
                                <h4 class="text-lg font-semibold text-gray-800">${item.TipoMP}</h4>
                                <span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">
                                    ${item.BarCode}
                                </span>
                            </div>
                            <p class="text-gray-600 mb-1">Fornecedor: ${item.fornecedor_nome}</p>
                            <p class="text-gray-600">CNPJ: ${item.fk_Fornecedores_CNPJ}</p>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-indigo-600 mb-1">${item.Quantidade}</div>
                            <div class="text-sm text-gray-500">unidades</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Carregar filtros
        async function carregarFiltros() {
            try {
                // Carregar tipos de MP
                const tiposResponse = await fetch(`${API_BASE_URL}/tipos-mp`);
                if (tiposResponse.ok) {
                    const tipos = await tiposResponse.json();
                    const filtroTipo = document.getElementById('filtroTipo');
                    filtroTipo.innerHTML = '<option value="">Todos os Tipos</option>' +
                        tipos.map(tipo => `<option value="${tipo.TipoMP}">${tipo.TipoMP}</option>`).join('');
                }

                // Carregar fornecedores
                const fornecedoresResponse = await fetch(`${API_BASE_URL}/fornecedores`);
                if (fornecedoresResponse.ok) {
                    const fornecedores = await fornecedoresResponse.json();
                    const filtroFornecedor = document.getElementById('filtroFornecedor');
                    filtroFornecedor.innerHTML = '<option value="">Todos os Fornecedores</option>' +
                        fornecedores.map(f => `<option value="${f.CNPJ}">${f.Nome}</option>`).join('');
                }
            } catch (error) {
                console.error('Erro ao carregar filtros:', error);
            }
        }

        // Filtrar estoque
        function filtrarEstoque() {
            const filtroTipo = document.getElementById('filtroTipo').value;
            const filtroFornecedor = document.getElementById('filtroFornecedor').value;
            const filtroBarcode = document.getElementById('filtroBarcode').value.toLowerCase();

            let dadosFiltrados = estoqueData.filter(item => {
                const matchTipo = !filtroTipo || item.TipoMP === filtroTipo;
                const matchFornecedor = !filtroFornecedor || item.fk_Fornecedores_CNPJ === filtroFornecedor;
                const matchBarcode = !filtroBarcode || item.BarCode.toLowerCase().includes(filtroBarcode);
                
                return matchTipo && matchFornecedor && matchBarcode;
            });

            renderizarEstoque(dadosFiltrados);
        }

        // Carregar Movimentações
        async function carregarMovimentacoes() {
            try {
                const response = await fetch(`${API_BASE_URL}/movimentacoes`);
                if (response.ok) {
                    movimentacaoData = await response.json();
                    renderizarMovimentacoes(movimentacaoData);
                } else {
                    throw new Error('Erro ao carregar movimentações');
                }
            } catch (error) {
                console.error('Erro ao carregar movimentações:', error);
                document.getElementById('listaMovimentacoes').innerHTML = `
                    <div class="p-6 text-center text-red-500">
                        Erro ao carregar dados de movimentação
                    </div>
                `;
            }
        }

        // Renderizar movimentações
        function renderizarMovimentacoes(dados) {
            const lista = document.getElementById('listaMovimentacoes');
            
            if (dados.length === 0) {
                lista.innerHTML = `
                    <div class="p-6 text-center text-gray-500">
                        Nenhuma movimentação encontrada
                    </div>
                `;
                return;
            }

            lista.innerHTML = dados.map(mov => `
                <div class="p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-4 mb-2">
                                <h4 class="text-lg font-semibold text-gray-800">${mov.tipo_movimento || 'Movimentação'}</h4>
                                <span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">
                                    ${mov.BarCode}
                                </span>
                            </div>
                            <p class="text-gray-600 mb-1">Máquina: ${mov.maquina_modelo || mov.fk_Maquina_Identificacao}</p>
                            <p class="text-gray-600">Funcionário: ${mov.funcionario_nome || 'N/A'}</p>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-gray-500">${formatDate(mov.DataHoraMovimento)}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Carregar Contatos
        async function carregarContatos() {
            try {
                const response = await fetch(`${API_BASE_URL}/contatos`);
                if (response.ok) {
                    contatosData = await response.json();
                    renderizarContatos(contatosData);
                } else {
                    throw new Error('Erro ao carregar contatos');
                }
            } catch (error) {
                console.error('Erro ao carregar contatos:', error);
                document.getElementById('contactsList').innerHTML = `
                    <div class="p-6 text-center text-red-500">
                        Erro ao carregar dados de contatos
                    </div>
                `;
            }
        }

        // Renderizar contatos
        function renderizarContatos(dados) {
            const lista = document.getElementById('contactsList');
            
            if (dados.length === 0) {
                lista.innerHTML = `
                    <div class="p-6 text-center text-gray-500">
                        Nenhum contato encontrado
                    </div>
                `;
                return;
            }

            lista.innerHTML = dados.map(contato => `
                <div class="p-6">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3 mb-2">
                                <h4 class="text-lg font-semibold text-gray-800">${contato.nome}</h4>
                                <span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">
                                    ${contato.projeto || 'BARCODER\'S'}
                                </span>
                            </div>
                            <p class="text-gray-600 mb-1">${contato.email}</p>
                            <p class="text-gray-800 font-medium mb-2">${contato.assunto}</p>
                            <p class="text-gray-600 mb-3">${contato.mensagem}</p>
                            <p class="text-sm text-gray-500">${formatDate(contato.data_envio)}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Funções auxiliares
        function formatDate(dateString) {
            if (!dateString) return 'Data não disponível';
            const date = new Date(dateString);
            return date.toLocaleString('pt-BR');
        }

        // Modais (placeholders para futuras implementações)
        function showAddItemModal() {
            showNotification('Funcionalidade em desenvolvimento - Adicionar Item');
        }

        function showEntradaModal() {
            showNotification('Funcionalidade em desenvolvimento - Registrar Entrada');
        }

        function showMovimentoModal() {
            showNotification('Funcionalidade em desenvolvimento - Registrar Movimento');
        }

        // Sistema de notificações
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            const bgColor = type === 'error' ? 'bg-red-500' : 'bg-green-500';
            notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animação de entrada
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
                notification.style.opacity = '1';
            }, 100);
            
            // Remover após 3 segundos
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                notification.style.opacity = '0';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, 3000);
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9904ecdff46c82f7',t:'MTc2MDc1Nzg5My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>